<!DOCTYPE html>
<html lang="en"><head>
<script src="lecture-09_files/libs/clipboard/clipboard.min.js"></script>
<script src="lecture-09_files/libs/quarto-html/tabby.min.js"></script>
<script src="lecture-09_files/libs/quarto-html/popper.min.js"></script>
<script src="lecture-09_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lecture-09_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lecture-09_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lecture-09_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.335">

  <meta name="author" content="Emi Tanaka">
  <title>ETC3250/5250: Introduction to Machine Learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lecture-09_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lecture-09_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lecture-09_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="assets/tachyons-addon.css">
  <link rel="stylesheet" href="assets/custom.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
  <link href="lecture-09_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lecture-09_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lecture-09_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lecture-09_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="lecture-09_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="lecture-09_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title"><span class="monash-blue"><em>Clustering</em></span> - table of contents</h2>
<ul>
<li><a href="#/etc5523-title" id="/toc-etc5523-title"><span class="monash-blue">ETC3250/5250</span></a>
<ul>
<li><a href="#/clustering" id="/toc-clustering">Clustering</a></li>
</ul></li>
<li><a href="#/cluster-analysis" id="/toc-cluster-analysis">Cluster analysis</a></li>
<li><a href="#/how-many-clusters-do-you-see" id="/toc-how-many-clusters-do-you-see">How many clusters do you see?</a></li>
<li><a href="#/a-possible-clustering" id="/toc-a-possible-clustering">A possible clustering</a></li>
<li><a href="#/approaches-to-clustering" id="/toc-approaches-to-clustering">Approaches to clustering</a></li>
<li><a href="#/hierarchical-clustering" id="/toc-hierarchical-clustering">Hierarchical clustering</a>
<ul>
<li><a href="#/distance" id="/toc-distance">Distance</a></li>
<li><a href="#/hierarchical-clustering-1" id="/toc-hierarchical-clustering-1">Hierarchical clustering</a></li>
<li><a href="#/agglomeration-method" id="/toc-agglomeration-method">Agglomeration method</a></li>
<li><a href="#/toy-data" id="/toc-toy-data"><i class="fas fa-basketball-ball"></i> Toy data</a></li>
<li><a href="#/single-linkage" id="/toc-single-linkage">Single linkage</a></li>
<li><a href="#/complete-linkage" id="/toc-complete-linkage">Complete linkage</a></li>
<li><a href="#/average-linkage" id="/toc-average-linkage">Average linkage</a></li>
<li><a href="#/centroid-linkage" id="/toc-centroid-linkage">Centroid linkage</a></li>
<li><a href="#/wards-method" id="/toc-wards-method">Ward’s method</a></li>
<li><a href="#/single-linkage-demo-iteration-0" id="/toc-single-linkage-demo-iteration-0"><i class="far fa-object-group"></i> Single linkage demo: iteration 0</a></li>
<li><a href="#/single-linkage-demo-iteration-1" id="/toc-single-linkage-demo-iteration-1"><i class="far fa-object-group"></i> Single linkage demo: iteration 1</a></li>
<li><a href="#/single-linkage-demo-iteration-2" id="/toc-single-linkage-demo-iteration-2"><i class="far fa-object-group"></i> Single linkage demo: iteration 2</a></li>
<li><a href="#/single-linkage-demo-iteration-3" id="/toc-single-linkage-demo-iteration-3"><i class="far fa-object-group"></i> Single linkage demo: iteration 3</a></li>
<li><a href="#/single-linkage-demo-iteration-4" id="/toc-single-linkage-demo-iteration-4"><i class="far fa-object-group"></i> Single linkage demo: iteration 4</a></li>
<li><a href="#/single-linkage-demo-iteration-5" id="/toc-single-linkage-demo-iteration-5"><i class="far fa-object-group"></i> Single linkage demo: iteration 5</a></li>
<li><a href="#/single-linkage-demo-iteration-6" id="/toc-single-linkage-demo-iteration-6"><i class="far fa-object-group"></i> Single linkage demo: iteration 6</a></li>
<li><a href="#/single-linkage-demo-iteration-7" id="/toc-single-linkage-demo-iteration-7"><i class="far fa-object-group"></i> Single linkage demo: iteration 7</a></li>
<li><a href="#/single-linkage-demo-iteration-8" id="/toc-single-linkage-demo-iteration-8"><i class="far fa-object-group"></i> Single linkage demo: iteration 8</a></li>
<li><a href="#/single-linkage-demo-iteration-9" id="/toc-single-linkage-demo-iteration-9"><i class="far fa-object-group"></i> Single linkage demo: iteration 9</a></li>
<li><a href="#/single-linkage-demo-iteration-10" id="/toc-single-linkage-demo-iteration-10"><i class="far fa-object-group"></i> Single linkage demo: iteration 10</a></li>
<li><a href="#/single-linkage-demo-iteration-11" id="/toc-single-linkage-demo-iteration-11"><i class="far fa-object-group"></i> Single linkage demo: iteration 11</a></li>
<li><a href="#/dendrogram" id="/toc-dendrogram"><i class="fab fa-pagelines"></i> Dendrogram</a></li>
<li><a href="#/cutting-the-tree" id="/toc-cutting-the-tree"><i class="fas fa-cut"></i> Cutting the tree</a></li>
<li><a href="#/chaining" id="/toc-chaining"><i class="fas fa-link"></i> Chaining</a></li>
<li><a href="#/inlier-and-outlier" id="/toc-inlier-and-outlier">Inlier and outlier</a></li>
<li><a href="#/robustness" id="/toc-robustness">Robustness</a></li>
</ul></li>
<li><a href="#/hierarchical-clustering-with-r" id="/toc-hierarchical-clustering-with-r"><i class="fab fa-r-project"></i> Hierarchical clustering with R</a>
<ul>
<li><a href="#/yale-face-database" id="/toc-yale-face-database"><i class="fas fa-database"></i> Yale face database</a></li>
<li><a href="#/principle-components-as-features" id="/toc-principle-components-as-features">Principle components as features</a></li>
<li><a href="#/dendrogram-with-r" id="/toc-dendrogram-with-r"><i class="fab fa-r-project"></i> Dendrogram with R</a></li>
<li><a href="#/cutting-the-tree-with-r" id="/toc-cutting-the-tree-with-r"><i class="fab fa-r-project"></i> Cutting the tree with R</a></li>
<li><a href="#/clustering-results" id="/toc-clustering-results">Clustering results</a></li>
</ul></li>
<li><a href="#/k-means-clustering" id="/toc-k-means-clustering"><span class="math inline">k</span>-means clustering</a>
<ul>
<li><a href="#/k-means-clustering-algorithm" id="/toc-k-means-clustering-algorithm"><span class="math inline">k</span>-means clustering algorithm</a></li>
<li><a href="#/k-means-demo-iteration-0" id="/toc-k-means-demo-iteration-0"><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 0</a></li>
<li><a href="#/k-means-demo-iteration-1" id="/toc-k-means-demo-iteration-1"><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 1</a></li>
<li><a href="#/k-means-demo-iteration-2" id="/toc-k-means-demo-iteration-2"><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 2</a></li>
<li><a href="#/k-means-demo-iteration-3" id="/toc-k-means-demo-iteration-3"><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 3</a></li>
<li><a href="#/k-means-clustering-in-r" id="/toc-k-means-clustering-in-r"><i class="fab fa-r-project"></i> <span class="math inline">k</span>-means clustering in R</a></li>
<li><a href="#/randomness-in-k-means-clustering" id="/toc-randomness-in-k-means-clustering"><i class="fas fa-exclamation-circle"></i> Randomness in <span class="math inline">k</span>-means clustering</a></li>
<li><a href="#/k-means-clustering-caveats" id="/toc-k-means-clustering-caveats"><i class="fas fa-exclamation-circle"></i> <span class="math inline">k</span>-means clustering caveats</a></li>
<li><a href="#/label-switching" id="/toc-label-switching">Label switching</a></li>
</ul></li>
<li><a href="#/takeaways" id="/toc-takeaways"><i class="fas fa-key"></i> Takeaways</a></li>
</ul>
</nav>
</section>
<section id="etc5523-title" class="slide level2" data-background-image="images/bg-01.png">
<h2><span class="monash-blue">ETC3250/5250</span></h2>
<p><span class="monash-blue f1"><strong>Introduction to Machine Learning</strong></span></p>
<h3 id="clustering">Clustering</h3>
<p>Lecturer: <em>Emi Tanaka</em></p>
<p>Department of Econometrics and Business Statistics</p>
</section>
<section id="cluster-analysis" class="slide level2">
<h2>Cluster analysis</h2>
<div>
<ul>
<li class="fragment">So far we have been working with cases where we have a response of interest (<strong>labelled data</strong>).</li>
<li class="fragment">In some instances, we only have a set of variables but no response of interest (<strong>unlabelled data</strong>).</li>
<li class="fragment">But we may be interested in finding an <em>unobserved grouping</em> within this unlabelled data, e.g.&nbsp;customer segmentation in marketing analysis.</li>
<li class="fragment">This is an example of <em>unsupervised learning</em>.</li>
</ul>
</div>
</section>
<section id="how-many-clusters-do-you-see" class="slide level2">
<h2>How many clusters do you see?</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/penguin-scatter_e0bb2b389e726a9577c3f5d7a2aa7f5b">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/penguin-scatter-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-possible-clustering" class="slide level2">
<h2>A possible clustering</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/penguins-kmeans_4b740ac54b302cfea5d9c6b1c5eb2b27">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/penguins-kmeans-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Here we cluster the observations into 3 groups… <span class="fragment"><em>but how?</em></span></li>
</ul>
</section>
<section id="approaches-to-clustering" class="slide level2">
<h2>Approaches to clustering</h2>
<ul>
<li><span class="monash-blue"><strong>Hierarchical</strong></span>:
<ul>
<li><strong>Agglomerative</strong>: One to all.</li>
<li><strong>Divisive</strong>: All to one.</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><span class="monash-blue"><strong>Non-hierarchical</strong></span>:
<ul>
<li>Select the number of clusters.</li>
<li>Then assign observations to clusters.</li>
<li><span class="fragment">We’ll use <strong><span class="math inline">k</span>-means clustering</strong> to show this.</span></li>
</ul></li>
</ul>
</div>
</section>
<section>
<section id="hierarchical-clustering" class="title-slide slide level1 mcenter center" data-background-color="#006DAE">
<h1>Hierarchical clustering</h1>

</section>
<section id="distance" class="slide level2">
<h2>Distance</h2>
<div>
<ul>
<li class="fragment">For clustering, we are grouping observations that are similar.</li>
<li class="fragment">Recall from Lecture 7, we covered some <a href="https://emitanaka.org/iml/lectures/lecture-07.html#/distance-metrics">distance metrics</a>.</li>
<li class="fragment">For clustering, we need two notions of distance:
<ul>
<li class="fragment">Distance between <em>observations</em></li>
<li class="fragment">Distance between <em>clusters</em></li>
</ul></li>
<li class="fragment">Let’s denote <span class="math inline">\mathcal{A}</span> and <span class="math inline">\mathcal{B}</span> as the two sets that contain the observation indexes of the two clusters<span class="fragment">, e.g.&nbsp;<span class="math inline">\mathcal{A} = \{1, 4\}</span> and <span class="math inline">\mathcal{B} = \{2, 3, 5\}</span> denotes that observations 1 and 4 are in the first cluster and observations 2, 3 and 5 are in the second cluster.</span></li>
</ul>
</div>
</section>
<section id="hierarchical-clustering-1" class="slide level2">
<h2>Hierarchical clustering</h2>
<div>
<ul>
<li class="fragment"><span class="monash-blue"><strong>Agglomerative</strong></span>: Start with all observations in singleton clusters. Merge clusters sequentially until all are in one cluster.</li>
<li class="fragment">The functions <code>hclust()</code> or <code>agnes()</code> can be used for this.</li>
<li class="fragment"><span class="monash-blue"><strong>Divisive</strong></span>: Start with all observtions in one cluster, and sequentially divide until all observations are in singleton clusters.</li>
<li class="fragment">The function <code>diana()</code> can be used for this.</li>
</ul>
</div>
</section>
<section id="agglomeration-method" class="slide level2">
<h2>Agglomeration method</h2>
<ul>
<li>There are several ways to merge clusters:
<ul>
<li><strong>Single linkage</strong>: <span class="math inline">D(\mathcal{A}, \mathcal{B}) = \min_{i\in\mathcal{A},j\in\mathcal{B}}D(\boldsymbol{x}_i,\boldsymbol{x}_j)</span></li>
<li><strong>Complete linkage</strong>: <span class="math inline">D(\mathcal{A}, \mathcal{B}) = \max_{i\in\mathcal{A},j\in\mathcal{B}}D(\boldsymbol{x}_i,\boldsymbol{x}_j)</span></li>
<li><strong>Average linkage</strong>: <span class="math inline">D(\mathcal{A}, \mathcal{B}) = \frac{1}{|\mathcal{A}||\mathcal{B}|}\sum_{i\in\mathcal{A}}\sum_{j\in\mathcal{B}}D(\boldsymbol{x}_i,\boldsymbol{x}_j)</span></li>
<li><strong>Centroid linkage</strong>: <span class="math inline">D(\mathcal{A}, \mathcal{B}) = D(\bar{\boldsymbol{x}}_\mathcal{A},\bar{\boldsymbol{x}}_\mathcal{B})</span>, combining based on distance between the centroid location of the each cluster</li>
<li><strong>Ward’s method</strong>: minimises the total within-cluster variance by merging clusters with minimum between-cluster distance.</li>
</ul></li>
</ul>
</section>
<section id="toy-data" class="slide level2">
<h2><i class="fas fa-basketball-ball"></i> Toy data</h2>
<ul>
<li>Suppose we have this data with four groups shown below.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/toy-cluster_d597cfcbfca111aa184d0b72c936ff72">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/toy-cluster-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="single-linkage" class="slide level2">
<h2>Single linkage</h2>
<p><span class="math display">D(\mathcal{A}, \mathcal{B}) = \min_{i\in\mathcal{A},j\in\mathcal{B}}D(\boldsymbol{x}_i,\boldsymbol{x}_j)</span></p>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/single-linkage-demo_3bebd3737e5468bc0894a64fac46da9d">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/single-linkage-demo-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Here we have 4 groups and 6 distances (based on ED) between clusters.</li>
</ul>
</section>
<section id="complete-linkage" class="slide level2">
<h2>Complete linkage</h2>
<p><span class="math display">D(\mathcal{A}, \mathcal{B}) = \max_{i\in\mathcal{A},j\in\mathcal{B}}D(\boldsymbol{x}_i,\boldsymbol{x}_j)</span></p>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/complete-linkage-demo_68c43b50f039990fe49f496b07cd8a0d">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/complete-linkage-demo-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-linkage" class="slide level2">
<h2>Average linkage</h2>
<p><span class="math display">D(\mathcal{A}, \mathcal{B}) = \frac{1}{|\mathcal{A}||\mathcal{B}|}\sum_{i\in\mathcal{A}}\sum_{j\in\mathcal{B}}D(\boldsymbol{x}_i,\boldsymbol{x}_j)</span></p>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/average-linkage-demo_e42f20609e389179a4fea3882414bdd8">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/average-linkage-demo-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="centroid-linkage" class="slide level2">
<h2>Centroid linkage</h2>
<p><span class="math display">D(\mathcal{A}, \mathcal{B}) = D(\bar{\boldsymbol{x}}_\mathcal{A},\bar{\boldsymbol{x}}_\mathcal{B})</span></p>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/centroid-linkage-demo_a0f89bcdc8bfe361235f1f0ca39bc8ea">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/centroid-linkage-demo-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="wards-method" class="slide level2">
<h2>Ward’s method</h2>
<ul>
<li><p>Minimises the total within-cluster sum of squares: <span class="math display">W = \sum_{k = 1}^g \left(\sum_{i\in\mathcal{A}_k}\sum_{j=1}^p\left(x_{ij} - \bar{x}_{\cdot j}\right)^2\right)</span> where:</p>
<ul>
<li><span class="math inline">\bar{x}_{\cdot j} = \frac{1}{|\mathcal{A}_k|}\sum_{i\in\mathcal{A}_k}x_{ij}</span>,</li>
<li><span class="math inline">\mathcal{A}_k</span> is a set of indexes for the <span class="math inline">k</span>-th group,</li>
<li><span class="math inline">g</span> is the number of cluster groups.</li>
</ul></li>
</ul>
</section>
<section id="single-linkage-demo-iteration-0" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 0</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/small-toy-data_c3876ad75dfd07263a0387c25a8ff059">

</div>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/small-toy-scatter_66a6128958f48d11a2a62bfbc7c5a15c">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/small-toy-scatter-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend0_2d38617c1326a6f90c33b1d3fb71c891">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend0-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Every observation starts as a singleton cluster.</li>
</ul>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-1" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 1</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter1_32be0eb18ee55c2267583e17b46b7543">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter1-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend1_1755c12791e6106f5732747726069fb7">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend1-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-2" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 2</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter2_8b222a7e142865cd6e169465b45fc4e3">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter2-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend2_ec5a2fc417af5dd55b4e3df5a0fa2ce7">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend2-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-3" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 3</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter3_66b15eb923f26785a49b6ba836485225">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter3-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend3_7155816306e872d8a1477b2649380e82">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend3-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-4" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 4</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter4_b03148b08c915b3527f7eb1218e347ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter4-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend4_eccb9367da8096db22d6055374620ba2">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend4-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-5" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 5</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter5_a66e48adf7b18489290dd1c6ac383cc9">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter5-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend5_f3eda53259e7734cce7f547afd0e2a92">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend5-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-6" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 6</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter6_56c09f98d1f8038f92d160375d2330fc">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter6-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend6_4e3112c52575a2eb10258e362d721dd1">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend6-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-7" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 7</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter7_54e7c0dfcc98afe332cf0edc549177d8">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter7-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend7_42917ada1092702b3d6447dcfcec0b33">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend7-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-8" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 8</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter8_3daa7e81a5b4f180360921c6e852e964">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter8-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend8_092186d1fa3c177e1e0a7c48557a9927">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend8-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-9" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 9</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter9_91d583b5461e78401d3cf5099c35c681">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter9-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend9_924db5aa160c3ad4b059ffd5160e3966">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend9-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-10" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 10</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter10_1bb95cbcfdbd660b933c84bd8110a9da">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter10-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend10_b9637bdf8f87a110212a1f409489f6bd">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend10-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="single-linkage-demo-iteration-11" class="slide level2">
<h2><i class="far fa-object-group"></i> Single linkage demo: iteration 11</h2>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/iter11_6a186ff98de6a1ceb66002baa29fddac">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/iter11-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-40 pl3">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dend11_905959381e922b365cb0eb67c83e419e">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dend11-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="dendrogram" class="slide level2">
<h2><i class="fab fa-pagelines"></i> Dendrogram</h2>
<div class="flex">
<div class="w-40">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dendro_184839cc044fc4b133b0cee2224d4909">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dendro-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-60 pl3">
<ul>
<li>Each leaf of the dendrogram represents one observation.</li>
<li>Leaves fuse into branches and branches fuse, either with leaves or other branches.<br>
</li>
<li>Fusions lower in the tree mean the groups of observations are more similar to each other.</li>
</ul>
</div>
</div>
</section>
<section id="cutting-the-tree" class="slide level2">
<h2><i class="fas fa-cut"></i> Cutting the tree</h2>
<ul>
<li>Cut the tree at a particular height results in a particular set of clusters.</li>
<li>For example, cutting the tree at the dashed red line below results in 4 clusters: (E), (G), (J, L, D, I K) and (A, B, C, F, H).</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/dendro-cut_5c09bee5533dca19591b8fcf15f49a3a">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/dendro-cut-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="chaining" class="slide level2">
<h2><i class="fas fa-link"></i> Chaining</h2>
<ul>
<li>Single linkage often suffers from <strong><em>chaining</em></strong>, i.e.&nbsp;a single observation results in merging two clusters.</li>
<li>This results in clusters that are spread out and not compact.</li>
</ul>
<div class="flex">
<div class="w-33 fragment">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/toy-chain_ee42d0c2de2c85acfb527a07761be5c7">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/toy-chain-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-33 pl3 fragment">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/toy-chain2_5c7d914b3c857ba6eebae0a519f6d838">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/toy-chain2-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-33 pl3 fragment">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/toy-chain3_a23e081e13991f92ae7ad4dd80f5adbd">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/toy-chain3-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inlier-and-outlier" class="slide level2">
<h2>Inlier and outlier</h2>
<div class="flex">
<div class="w-50">
<ul>
<li>An <em>inlier</em> is an erroneous observation that lies within the interior of a distribution.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/inlier-example_daad4b0b0394af9a1328c6f2340f8972">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/inlier-example-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="w-50 pl3">
<ul>
<li>An <em>outlier</em> is an observation that lies well outside the typical range of values.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/outlier-example_2323626349a392912fc95f0a7560dadc">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/outlier-example-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="robustness" class="slide level2">
<h2>Robustness</h2>
<div>
<ul>
<li class="fragment">Methods that are not often affected by single observations are referred to be <em>robust</em>.</li>
<li class="fragment">Single linkage is easily affected by inliers.</li>
<li class="fragment">Complete linkage less affected by inliers but affected by outliers.</li>
<li class="fragment">Other methods like average linkage, centroid linkage and Ward’s method are more robust.</li>
</ul>
</div>
</section></section>
<section>
<section id="hierarchical-clustering-with-r" class="title-slide slide level1 mcenter center" data-background-color="#006DAE">
<h1><i class="fab fa-r-project"></i> Hierarchical clustering with R</h1>

</section>
<section id="yale-face-database" class="slide level2">
<h2><i class="fas fa-database"></i> Yale face database</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/yale-data_90b70079139d49a147d9d1d69df2a314">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">Sys.setenv</span>(<span class="at">VROOM_CONNECTION_SIZE =</span> <span class="dv">5000000</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>yalefaces <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://emitanaka.org/iml/data/yalefaces.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>imagedata_to_plotdata <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">data =</span> yalefaces, </span>
<span id="cb1-5"><a href="#cb1-5"></a>                                  <span class="at">w =</span> <span class="dv">320</span>, </span>
<span id="cb1-6"><a href="#cb1-6"></a>                                  <span class="at">h =</span> <span class="dv">243</span>, </span>
<span id="cb1-7"><a href="#cb1-7"></a>                                  <span class="at">which =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">165</span>, <span class="dv">15</span>)) {</span>
<span id="cb1-8"><a href="#cb1-8"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="fu">filter</span>(id <span class="sc">%in%</span> which) <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11"></a>    <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"V"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-12"><a href="#cb1-12"></a>    <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>w, <span class="at">each =</span> h), <span class="fu">n_distinct</span>(id)),</span>
<span id="cb1-13"><a href="#cb1-13"></a>           <span class="at">row =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>h, <span class="at">times =</span> w), <span class="fu">n_distinct</span>(id)))</span>
<span id="cb1-14"><a href="#cb1-14"></a>}</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a>gfaces <span class="ot">&lt;-</span> <span class="fu">imagedata_to_plotdata</span>(yalefaces) <span class="sc">%&gt;%</span> </span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(col, row)) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> </span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject <span class="sc">+</span> type, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>    <span class="fu">scale_y_reverse</span>() <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>    <span class="fu">theme_void</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="fu">coord_equal</span>()</span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a>gfaces</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/yale-data-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="principle-components-as-features" class="slide level2">
<h2>Principle components as features</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/yalepca_03dd79157ff46b8192f63e47ba0607f6">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>yalefaces_x <span class="ot">&lt;-</span> yalefaces <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(subject, type))</span>
<span id="cb2-3"><a href="#cb2-3"></a>yalefaces_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(yalefaces_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Applying hierarchical clustering with various methods:</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/hclust-methods_5d31927abb1ae63f828ec1b9de58d3de">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>hsingle <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x), <span class="at">method =</span> <span class="st">"single"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>hcomplete <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x), <span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>haverage <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x), <span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>hcentroid <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x), <span class="at">method =</span> <span class="st">"centroid"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>hward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x), <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># add labels </span></span>
<span id="cb3-7"><a href="#cb3-7"></a>hsingle<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Subject"</span>, yalefaces<span class="sc">$</span>subject, yalefaces<span class="sc">$</span>type)</span>
<span id="cb3-8"><a href="#cb3-8"></a>hcomplete<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Subject"</span>, yalefaces<span class="sc">$</span>subject, yalefaces<span class="sc">$</span>type)</span>
<span id="cb3-9"><a href="#cb3-9"></a>haverage<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Subject"</span>, yalefaces<span class="sc">$</span>subject, yalefaces<span class="sc">$</span>type)</span>
<span id="cb3-10"><a href="#cb3-10"></a>hcentroid<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Subject"</span>, yalefaces<span class="sc">$</span>subject, yalefaces<span class="sc">$</span>type)</span>
<span id="cb3-11"><a href="#cb3-11"></a>hward<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Subject"</span>, yalefaces<span class="sc">$</span>subject, yalefaces<span class="sc">$</span>type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dendrogram-with-r" class="slide level2 scrollable">
<h2><i class="fab fa-r-project"></i> Dendrogram with R</h2>
<p><span class="f4 absolute top-1 right-1" style=""><i class="fas fa-long-arrow-alt-down"></i> scroll</span></p>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/ggdendro_58956164fc8d0b1925ebf7fa20624ee6">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(ggdendro)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">ggdendrogram</span>(hward, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ward's method"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/ggdendro-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cutting-the-tree-with-r" class="slide level2">
<h2><i class="fab fa-r-project"></i> Cutting the tree with R</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree_bfd9d3cf112d1fb05c24950df3dfaea2">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>cward <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hward, <span class="at">k =</span> <span class="dv">15</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>cward</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Subject 1 centerlight      Subject 1 glasses        Subject 1 happy 
                     1                      1                      1 
   Subject 1 leftlight    Subject 1 noglasses       Subject 1 normal 
                     2                      3                      1 
  Subject 1 rightlight          Subject 1 sad       Subject 1 sleepy 
                     4                      1                      1 
   Subject 1 surprised         Subject 1 wink  Subject 2 centerlight 
                     1                      1                      3 
     Subject 2 glasses        Subject 2 happy    Subject 2 leftlight 
                     3                      3                      2 
   Subject 2 noglasses       Subject 2 normal   Subject 2 rightlight 
                     3                      3                      5 
         Subject 2 sad       Subject 2 sleepy    Subject 2 surprised 
                     3                      3                      3 
        Subject 2 wink  Subject 3 centerlight      Subject 3 glasses 
                     3                      6                      6 
       Subject 3 happy    Subject 3 leftlight    Subject 3 noglasses 
                     7                      8                      7 
      Subject 3 normal   Subject 3 rightlight          Subject 3 sad 
                     7                      4                      7 
      Subject 3 sleepy    Subject 3 surprised         Subject 3 wink 
                     7                      7                      7 
 Subject 4 centerlight      Subject 4 glasses        Subject 4 happy 
                     5                      5                      5 
   Subject 4 leftlight    Subject 4 noglasses       Subject 4 normal 
                     2                      5                      5 
  Subject 4 rightlight          Subject 4 sad       Subject 4 sleepy 
                     4                      5                      5 
   Subject 4 surprised         Subject 4 wink  Subject 5 centerlight 
                     5                      5                      9 
     Subject 5 glasses        Subject 5 happy    Subject 5 leftlight 
                     9                      9                      2 
   Subject 5 noglasses       Subject 5 normal   Subject 5 rightlight 
                     9                      9                      4 
         Subject 5 sad       Subject 5 sleepy    Subject 5 surprised 
                     9                      9                      9 
        Subject 5 wink  Subject 6 centerlight      Subject 6 glasses 
                     9                     10                     11 
       Subject 6 happy    Subject 6 leftlight    Subject 6 noglasses 
                    11                      8                     11 
      Subject 6 normal   Subject 6 rightlight          Subject 6 sad 
                    11                     10                     11 
      Subject 6 sleepy    Subject 6 surprised         Subject 6 wink 
                    11                     11                     11 
 Subject 7 centerlight      Subject 7 glasses        Subject 7 happy 
                     6                      7                      6 
   Subject 7 leftlight    Subject 7 noglasses       Subject 7 normal 
                     8                      7                      7 
  Subject 7 rightlight          Subject 7 sad       Subject 7 sleepy 
                     4                      7                      7 
   Subject 7 surprised         Subject 7 wink  Subject 8 centerlight 
                     7                      7                      7 
     Subject 8 glasses        Subject 8 happy    Subject 8 leftlight 
                     7                      7                      8 
   Subject 8 noglasses       Subject 8 normal   Subject 8 rightlight 
                     7                      7                      4 
         Subject 8 sad       Subject 8 sleepy    Subject 8 surprised 
                     6                      7                      6 
        Subject 8 wink  Subject 9 centerlight      Subject 9 glasses 
                     6                      6                      6 
       Subject 9 happy    Subject 9 leftlight    Subject 9 noglasses 
                    12                      2                     12 
      Subject 9 normal   Subject 9 rightlight          Subject 9 sad 
                    12                      4                     12 
      Subject 9 sleepy    Subject 9 surprised         Subject 9 wink 
                    12                     12                     12 
Subject 10 centerlight     Subject 10 glasses       Subject 10 happy 
                     1                      6                     13 
  Subject 10 leftlight   Subject 10 noglasses      Subject 10 normal 
                     2                     13                     13 
 Subject 10 rightlight         Subject 10 sad      Subject 10 sleepy 
                     5                     13                     13 
  Subject 10 surprised        Subject 10 wink Subject 11 centerlight 
                    13                     13                     14 
    Subject 11 glasses       Subject 11 happy   Subject 11 leftlight 
                    14                     14                      8 
  Subject 11 noglasses      Subject 11 normal  Subject 11 rightlight 
                    14                     14                     14 
        Subject 11 sad      Subject 11 sleepy   Subject 11 surprised 
                    14                     14                     14 
       Subject 11 wink Subject 12 centerlight     Subject 12 glasses 
                    14                      3                      3 
      Subject 12 happy   Subject 12 leftlight   Subject 12 noglasses 
                     9                      2                      2 
     Subject 12 normal  Subject 12 rightlight         Subject 12 sad 
                     2                      3                      9 
     Subject 12 sleepy   Subject 12 surprised        Subject 12 wink 
                     9                      9                      9 
Subject 13 centerlight     Subject 13 glasses       Subject 13 happy 
                     6                     15                     15 
  Subject 13 leftlight   Subject 13 noglasses      Subject 13 normal 
                     8                     15                     15 
 Subject 13 rightlight         Subject 13 sad      Subject 13 sleepy 
                     4                     15                     15 
  Subject 13 surprised        Subject 13 wink Subject 14 centerlight 
                    15                     15                     10 
    Subject 14 glasses       Subject 14 happy   Subject 14 leftlight 
                    10                     10                      8 
  Subject 14 noglasses      Subject 14 normal  Subject 14 rightlight 
                    10                     10                     10 
        Subject 14 sad      Subject 14 sleepy   Subject 14 surprised 
                    10                     10                     10 
       Subject 14 wink Subject 15 centerlight     Subject 15 glasses 
                    10                      7                     13 
      Subject 15 happy   Subject 15 leftlight   Subject 15 noglasses 
                     6                      8                     13 
     Subject 15 normal  Subject 15 rightlight         Subject 15 sad 
                     7                      4                      6 
     Subject 15 sleepy   Subject 15 surprised        Subject 15 wink 
                    13                     13                      6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">table</span>(cward) <span class="co"># 15 groups </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cward
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 
 9  9 13  9 11 14 22  8 14 12  8  7 11 10  8 </code></pre>
</div>
</div>
</section>
<section id="clustering-results" class="slide level2 scrollable">
<h2>Clustering results</h2>
<p><span class="f4 absolute top-1 right-1" style=""><i class="fas fa-long-arrow-alt-down"></i> scroll</span></p>
<ul>
<li><p>Remember for the following we never used subject id variable in the clustering.</p></li>
<li><p>Cluster 1 is mostly subject 1!</p></li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view_4e871fd8eeb66628f6f47e4762b258af">

</div>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view1_1f169d5ff3d884aa6197110f68b392dc">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 2 seems to be capturing mostly the left light.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view2_bf47e8d8065a8cc9d6206289450561ab">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 3 is mostly subject 2.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view3_b3c7fe1e859f7e31eb2b5418fb9a166f">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view3-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 4 is mostly right light.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view4_bef98bab41bba22ea011bbe104795929">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 5 is mostly subject 4</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view5_d45bb205e04990c2453bb60e3e50c266">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view5-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 6 is a mix</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view6_ed2d515ec53a7a9da40f814e50e04112">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view6-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 7 contains mostly subject 3, 7 and 8</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view7_12a4b677d8f48a8cdfdbe04a1165acd6">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 8 is the left light</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view8_603af3272510b96e578301dbb012fb82">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view8-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 9 is subjects 5 and 12</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view9_3818ad46b63b1c09d053074c4c4ed6e8">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view9-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 10 is mostly subject 14</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view10_12fde295d3faa2da1a40a26c3ceba899">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view10-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 11 is subject 6</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view11_066cefdc3cbaff8961eb68d37f93500d">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view11-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 12 is subject 9</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view12_e3e2ae36e2e9714f66231199d55d57ad">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view12-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 13 is subjects 10 and 15</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view13_d8db1dafb2f8ce4254405e8b211ffa8b">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view13-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 14 is subject 11</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view14_18d5c53cae3fa5bc24434b46dcc75936">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Cluster 15 is subject 13</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/cutree-clusters-view15_52be37856b8c64fddcbdbbba674e78e9">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/cutree-clusters-view15-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="k-means-clustering" class="title-slide slide level1 mcenter center" data-background-color="#006DAE">
<h1><span class="math inline">k</span>-means clustering</h1>

</section>
<section id="k-means-clustering-algorithm" class="slide level2">
<h2><span class="math inline">k</span>-means clustering algorithm</h2>
<div>
<ul>
<li class="fragment">The number of clusters, <span class="math inline">k</span>, must be decided apriori to using this method.</li>
<li class="fragment">In <span class="math inline">k</span>-means clustering, each observation must be closest to the centroid (or mean) of its own cluster.</li>
<li class="fragment">This method is iterative and follows along the lines of:
<ol type="1">
<li class="fragment">Initially start with <span class="math inline">k</span> partitions of data or <span class="math inline">k</span> seed points.</li>
<li class="fragment">Assign observations to the cluster with the closest mean.</li>
<li class="fragment">Recompute centroids of each cluster.</li>
<li class="fragment">Repeat steps 2-3 until convergence.</li>
</ol></li>
</ul>
</div>
</section>
<section id="k-means-demo-iteration-0" class="slide level2">
<h2><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 0</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/unnamed-chunk-2_6f15a0467c06d83accde48f106986d36">

</div>
<ul>
<li>Select <span class="math inline">k = 2</span> with initial seed points <span class="math inline">(2.5, 6)</span> and <span class="math inline">(7.5, 7)</span>.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans0_f33ed5a2e592fe0efad576246af04077">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/kmeans0-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-demo-iteration-1" class="slide level2">
<h2><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 1</h2>
<ul>
<li>Assign observations to the closest seed point.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans1_eca4142b79a926730312ddd09e27e6ef">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/kmeans1-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-demo-iteration-2" class="slide level2">
<h2><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 2</h2>
<ul>
<li>Recompute the centroids.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans2_b0d9b534d6591815699a5754e32450f6">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/kmeans2-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-demo-iteration-3" class="slide level2">
<h2><i class="far fa-object-group"></i> <span class="math inline">k</span>-means demo: iteration 3</h2>
<ul>
<li>Assign observations to the closest centroid.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans3_32d7e94f115df0c9803fdf7211e8639e">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/lecture-09.rmarkdown/kmeans3-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-clustering-in-r" class="slide level2">
<h2><i class="fab fa-r-project"></i> <span class="math inline">k</span>-means clustering in R</h2>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans-r_8ded6c6798e355244626fbdbbd67d57a">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">15</span>) <span class="co"># `scale` the data if different measurement units</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">str</span>(kout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 9
 $ cluster     : int [1:165] 12 12 12 8 4 12 11 12 12 12 ...
 $ centers     : num [1:15, 1:165] -6146 16755 -14911 -9669 22233 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:15] "1" "2" "3" "4" ...
  .. ..$ : chr [1:165] "PC1" "PC2" "PC3" "PC4" ...
 $ totss       : num 5.63e+10
 $ withinss    : num [1:15] 8.93e+08 8.32e+08 5.04e+08 1.35e+09 5.06e+08 ...
 $ tot.withinss: num 1.56e+10
 $ betweenss   : num 4.07e+10
 $ size        : int [1:15] 14 6 5 14 8 10 11 12 14 11 ...
 $ iter        : int 3
 $ ifault      : int 0
 - attr(*, "class")= chr "kmeans"</code></pre>
</div>
</div>
<ul>
<li><code>cluster</code> contains the cluster number of the observation</li>
</ul>
</section>
<section id="randomness-in-k-means-clustering" class="slide level2">
<h2><i class="fas fa-exclamation-circle"></i> Randomness in <span class="math inline">k</span>-means clustering</h2>
<ul>
<li>The <span class="math inline">k</span>-means algorithm can yield quite different results depending on the initial seed.</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans-r2_a62f07ff32bf5cc14e22b8fd8bf1be17">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>kout1 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">15</span>) </span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">table</span>(kout1<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 
11  3 13  9  9  5 15 12 25 20 10  8  8  7 10 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans-r3_9fb8e27f1d798a570c29ba6134288f68">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>kout2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">15</span>) </span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">table</span>(kout2<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 
15 10 15  8  7 15 10  8 10 21 13  9  9  5 10 </code></pre>
</div>
</div>
</div>
</section>
<section id="k-means-clustering-caveats" class="slide level2">
<h2><i class="fas fa-exclamation-circle"></i> <span class="math inline">k</span>-means clustering caveats</h2>
<ul>
<li>Unlike hierarchical clustering, the result for different number of clusters can contradict each other!</li>
</ul>
<div class="flex">
<div class="w-60">
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/kmeans-r4_881c14b1f4afa5a16181b0e4bba4c8ec">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>kout3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">3</span>) </span>
<span id="cb15-2"><a href="#cb15-2"></a>kout5 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">5</span>) </span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">table</span>(kout3<span class="sc">$</span>cluster, kout5<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
     1  2  3  4  5
  1  0 47 14  0  5
  2 15  0  0  0 55
  3  0  0  0 29  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>hout3 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x)), <span class="dv">3</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>hout5 <span class="ot">&lt;-</span> <span class="fu">cutree</span>(<span class="fu">hclust</span>(<span class="fu">dist</span>(yalefaces_pca<span class="sc">$</span>x)), <span class="dv">5</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="fu">table</span>(hout3, hout5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     hout5
hout3  1  2  3  4  5
    1 76  0  0 43  0
    2  0 17  0  0  0
    3  0  0  9  0 20</code></pre>
</div>
</div>
</div>
<div class="w-20 pl3">
<ul>
<li><span class="math inline">k</span>-means:
<ul>
<li><span class="math inline">1\rightarrow 2, 3, 5</span></li>
<li><span class="math inline">2\rightarrow 1, 5</span></li>
<li><span class="math inline">3\rightarrow 4</span></li>
</ul></li>
</ul>
</div>
<div class="w-20 pl3">
<ul>
<li>hierarchical:
<ul>
<li><span class="math inline">1\rightarrow 1, 4</span></li>
<li><span class="math inline">2\rightarrow 2</span></li>
<li><span class="math inline">3\rightarrow 3, 5</span></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="label-switching" class="slide level2">
<h2>Label switching</h2>
<ul>
<li>Cluster labels can be switched around.</li>
<li>Cluster 1 can be equivalent to Cluster 2 in another iteration – the number doesn’t matter.</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="cache/lecture-09.rmarkdown/label-switch_a0196bc450e81c99ce4edee987c495f6">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>koutA <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">5</span>) </span>
<span id="cb19-2"><a href="#cb19-2"></a>koutB <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(yalefaces_pca<span class="sc">$</span>x, <span class="at">centers =</span> <span class="dv">5</span>) </span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">table</span>(koutA<span class="sc">$</span>cluster, koutB<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
     1  2  3  4  5
  1 16 53  0  0  0
  2  6  0  0 44  0
  3  0  0  0  0 18
  4  0  0  0  0 11
  5  0  0 17  0  0</code></pre>
</div>
</div>
<ul>
<li>Here Cluster 5 in A is Cluster 3 in B.</li>
</ul>
</section></section>
<section id="takeaways" class="title-slide slide level1 mcenter center" data-background-color="#006DAE">
<h1><i class="fas fa-key"></i> Takeaways</h1>
<ul>
<li>Clustering is an unsupervised learning.</li>
<li>There are many methods for clustering.</li>
<li>Clustering helps to explore data.</li>
<li>The choice of the number of clusters largely depends on the context of the problem – too many clusters may not be helpful but neither is too few.</li>
</ul>
<p><img src="images/monash-one-line-black-rgb.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>ETC3250/5250 Week 9</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lecture-09_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lecture-09_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lecture-09_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lecture-09_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":5},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: true,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <link rel="stylesheet" href="assets/syntax-highlight.css">
    <link rel="stylesheet" href="assets/monash-after-body.css">
    <link rel="stylesheet" href="assets/fontawesome-free-6.1.1-web/css/all.css">
    <script src="assets/fontawesome-free-6.1.1-web/js/all.js"></script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>